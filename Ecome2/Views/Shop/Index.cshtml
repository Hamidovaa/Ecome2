@model TwoModels

@section Styles{
    <style>
        .hidden-checkbox {
            display: none;
        }

        .label-circle {
            display: flex;
            align-items: center;
            cursor: pointer;
            margin-bottom: 5px;
        }

            .label-circle .circle {
                width: 20px;
                height: 20px;
                display: inline-block;
                margin-right: 5px;
                border-radius: 50%;
                border: 1px solid transparent; /* Varsayılan kenarlık */
            }

        .hidden-checkbox:checked + .circle {
            border: 2px solid black; /* Seçili olan renklerin etrafına siyah kenarlık ekler */
        }



    </style>
}
<div class="container container-240 shop-collection">
    <ul class="breadcrumb">
        <li><a href="#">Home</a></li>
        <li class="active">Shop</li>
    </ul>
    <div class="filter-collection-left hidden-lg hidden-md">
        <a class="btn">Filter</a>
    </div>

    <div class="row shop-colect">

        <div class="col-md-3 col-sm-3 col-xs-12 col-left collection-sidebar" id="filter-sidebar">
            <div class="close-sidebar-collection hidden-lg hidden-md">
                <span>filter</span><i class="icon_close ion-close"></i>
            </div>
            <div class="filter filter-cate">
                <ul class="wiget-content v2">
                    @foreach (var item in Model.categories)
                    {
                        <li class="active">
                            <a href="#">
                                @item.Name<span class="number">(80)</span>
                            </a>
                        </li>
                    }
                </ul>
            </div>
            <div class="filter filter-group">
                <h1 class="widget-blog-title" style="color:black" >Product filter</h1>
                <form method="post" action="@Url.Action("Filter", "Shop")">
                    <div class="filter-brand filter-inside">
                        <h3>Color</h3>
                        <ul class="e-filter brand-filter">
                            @foreach (var item in Model.colors)
                            {
                                <li>
                                    <input type="checkbox" id="color-@item.Id" name="SelectedColors" value="@item.Id" />
                                    <label for="color-@item.Id"> <span class="circle" style="background-color:@item.Code;"></span>
                                        @item.Name</label>
                                </li>
                            }
                        </ul>
                    </div>
                    <div class="filter-brand filter-inside">
                        <h3>Size</h3>
                        <ul class="e-filter brand-filter">
                            @foreach (var item in Model.sizes)
                            {
                                <li>
                                    <input type="checkbox" id="size-@item.Id" name="SelectedSizes" value="@item.Id" />
                                    <label for="size-@item.Id">@item.Name</label>
                                </li>
                            }
                        </ul>
                    </div>
                    <div class="filter-price filter-inside">
                        <div class="wrapper">
                            <div class="values">
                                <span id="range1">0</span>
                                <span> &dash; </span>
                                <span id="range2">4000</span>
                            </div>
                            <div class="containerr">
                                <div class="slider-track"></div>
                                <input type="range" min="0" max="4000" value="200" id="slider-1" name="MinPrice" oninput="slideOne()">
                                <input type="range" min="0" max="4000" value="1000" id="slider-2" name="MaxPrice" oninput="slideTwo()">
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="filter-button">Filter</button>
                </form>


            </div>
        </div>
        <div class="col-md-9 col-sm-12 col-xs-12 collection-list">
            <div class="e-product">
               @*  <div class="pd-top">
                    <h1 class="title">Shop</h1>
                    <div class="show-element"><span>Showing 1–15 of 20 results</span></div>
                </div> *@
                <div class="pd-middle">
                    <div class="view-mode view-group">
                        <a class="grid-icon col"><img src="~/demo/img/grid.png" alt=""></a>
                        <a class="grid-icon col2"><img src="~/demo/img/grid2.png" alt=""></a>
                        <a class="list-icon list active"><img src="~/demo/img/list.png" alt=""></a>
                    </div>
                    <div class="pd-sort">
                        <div class="filter-sort">
                            <div class="dropdown">
                                <button class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                    <span class="dropdown-label">Default sorting</span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="manual.html">Featured</a></li>
                                    <li><a href="best-selling.html">Best Selling</a></li>
                                    <li><a href="title-ascending.html">Alphabetically, A-Z</a></li>
                                    <li><a href="title-descending.html">Alphabetically, A-Z</a></li>
                                    <li><a href="price-descending.html">Price, high to low</a></li>
                                    <li><a href="price-ascending.html">Price, low to high</a></li>
                                    <li><a href="created-ascending.html">Date, old to new</a></li>
                                    <li><a href="created-descending.html">Date, new to old</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="filter-show">
                            <div class="dropdown">
                                <button class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                    Show
                                    <span class="dropdown-label">12</span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="#">12</a></li>
                                    <li><a href="#">24</a></li>
                                    <li><a href="#">36</a></li>
                                    <li><a href="#">48</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="product-collection-grid product-grid product-list product-grid-v2">
                    <div class="row">
                        @foreach (var product in Model.products)
                        {
                            <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 product-item">
                                <div class="pd-bd product-inner">
                                    <div class="product-img">
                                        <a asp-controller="Shop" asp-action="ProductDetail" asp-route-id="@product.Id"><img src="~/UploadProducts/@product.ImgUrlBase" alt="" class="img-reponsive"></a>
                                    </div>
                                    
                                    <div class="product-info">
                                        <div class="color-group"></div>
                                        <div class="element-list element-list-left">
                                            <ul class="desc-list" style="display: flex; list-style-type: none; padding: 0; list-style:none;">
                                                @foreach (var color in product.ProductColors)
                                                {
                                                    <li>
                                                        <input type="checkbox" id="color-@color.ColorId" name="SelectedColors" value="@color.ColorId" class="hidden-checkbox" />
                                                        <label for="color-@color.ColorId" class="label-circle">
                                                            <span class="circle" style="background-color:@color.Color.Code"></span>
                                                            @color.Color.Name
                                                        </label>
                                                    </li>
                                                }

                                               
                                               
                                            </ul>
                                            <ul class="desc-list">
                                                @foreach (var size in product.ProductSizes)
                                                {
                                                    <li>
                                                        <input type="checkbox" id="color-@size.SizeId" name="SelectedColors" value="@size.SizeId" class="hidden-checkbox" />
                                                        <label for="color-@size.SizeId" class="label-circle">
                                                            @size.Size.Name
                                                        </label>
                                                    </li>
                                                }
                                            
                                            </ul>
                                        </div>
                                        <div class="element-list element-list-middle">
                                            <div class="product-rating bd-rating">
                                                <span class="star star-5"></span>
                                                <span class="star star-4"></span>
                                                <span class="star star-3"></span>
                                                <span class="star star-2"></span>
                                                <span class="star star-1"></span>
                                                <div class="number-rating">( 896 reviews )</div>
                                            </div>
                                            <h3 class="product-title"><a asp-controller="Shop" asp-action="ProductDetail" asp-route-id="@product.Id">@product.Title</a></h3>
                                            <p class="product-cate">@product.Description</p>
                                            <div class="product-bottom">
                                                @* @if (product.OldPrice != null || product.OldPrice != 0)
                                                {
                                                    <div class="product-price"><span>@product.OldPrice AZN</span></div>
                                                } *@
                                                
                                                <div class="product-price"><span>@product.Price AZN</span></div>
                                                <a href="#" class="btn-icon btn-view">
                                                    <span class="icon-bg icon-view"></span>
                                                </a>
                                            </div>
                                            <div class="product-bottom-group">
                                                <a onclick="addToCart(@product.Id)" class="btn-icon">
                                                    <span class="icon-bg icon-cart"></span>
                                                </a>

                                                <a onclick="AddToWisList(@product.Id)" class="btn-icon">
                                                    <span class="icon-bg icon-wishlist"></span>
                                                </a>
                                                <a href="#" class="btn-icon">
                                                    <span class="icon-bg icon-compare"></span>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="product-button-group">
                                            <a href="#" class="btn-icon">
                                                <span class="icon-bg icon-cart"></span>
                                            </a>
                                            <a href="#" class="btn-icon">
                                                <span class="icon-bg icon-wishlist"></span>
                                            </a>
                                            <a href="#" class="btn-icon">
                                                <span class="icon-bg icon-compare"></span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div> 
                        }
                    </div>
                </div>
                <div class="pd-middle space-v1">
                    <ul class="pagination">
                        <li class="active"><a href="#">1</a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#"><i class="ion-ios-arrow-forward"></i></a></li>
                    </ul>
                    <div class="pd-sort">
                        <div class="filter-sort">
                            <div class="dropdown">
                                <button class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                    <span class="dropdown-label">Default sorting</span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="manual.html">Featured</a></li>
                                    <li><a href="best-selling.html">Best Selling</a></li>
                                    <li><a href="title-ascending.html">Alphabetically, A-Z</a></li>
                                    <li><a href="title-descending.html">Alphabetically, A-Z</a></li>
                                    <li><a href="price-descending.html">Price, high to low</a></li>
                                    <li><a href="price-ascending.html">Price, low to high</a></li>
                                    <li><a href="created-ascending.html">Date, old to new</a></li>
                                    <li><a href="created-descending.html">Date, new to old</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="filter-show">
                            <div class="dropdown">
                                <button class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                    Show
                                    <span class="dropdown-label">12</span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="#">12</a></li>
                                    <li><a href="#">24</a></li>
                                    <li><a href="#">36</a></li>
                                    <li><a href="#">48</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts {
   <script>
        $(".view-mode > a").on("click", function () {
            $(this).addClass('active').siblings().removeClass('active');;

            if ($(this).hasClass('col2')) {
                $(".product-grid").addClass("product-grid-v2");
                $(".product-grid").removeClass("product-list");
            }
            if ($(this).hasClass('col')) {
                $(".product-grid").removeClass("product-grid-v2 product-list");
            }
            if ($(this).hasClass('list')) {
                $(".product-grid").addClass("product-list product-grid-v2");
            }
        });
   </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        function slideOne() {
            var sliderOne = document.getElementById("slider-1");
            var displayValueOne = document.getElementById("range1");
            displayValueOne.innerText = sliderOne.value;
        }

        function slideTwo() {
            var sliderTwo = document.getElementById("slider-2");
            var displayValueTwo = document.getElementById("range2");
            displayValueTwo.innerText = sliderTwo.value;
        }
    </script>
    <script>
        function addToCart(productId) {
            $.ajax({
                url: '@Url.Action("AddToCart", "Cart")',
                type: 'POST',
                data: { id: productId },
                success: function (response) {
                    window.location.href = '@Url.Action("Index", "Shop")';
                },
                error: function () {
                    alert('Ürün sepete eklenemedi.');
                }
            });
        }
    </script>
    <script>
        $(document).ready(function () {
            // Sayfa yüklendiğinde localStorage'dan favori sayısını al ve güncelle
            var wishlistCount = localStorage.getItem('wishlistCount');
            if (wishlistCount) {
                $('.cart-count').text(wishlistCount);
            }
        });

        function AddToWisList(productId) {
            $.ajax({
                url: '@Url.Action("AddToWisList", "Wishlist")',
                type: 'POST',
                data: { id: productId },
                success: function (response) {
                    if (response.success) {
                        if (response.isNewItem) {
                            // Favori sayısını güncelle ve localStorage'a kaydet
                            $('.cart-count').text(response.wishlistCount);
                            localStorage.setItem('wishlistCount', response.wishlistCount);
                        }
                    } else {
                        alert('Ürün favorilere eklenemedi.');
                    }
                },
                error: function () {
                    alert('Ürün favorilere eklenemedi.');
                }
            });
        }
    </script>
    <script>
        window.onload = function () {
            slideOne();
            slideTwo();
        }

        let sliderOne = document.getElementById("slider-1");
        let sliderTwo = document.getElementById("slider-2");
        let displayValOne = document.getElementById("range1");
        let displayValTwo = document.getElementById("range2");
        let minGap = 0;
        let sliderTrack = document.querySelector(".slider-track");
        let sliderMaxValue = document.getElementById("slider-1").max;

        function slideOne() {
            if (parseInt(sliderTwo.value) - parseInt(sliderOne.value) <= minGap) {
                sliderOne.value = parseInt(sliderTwo.value) - minGap;
            }
            displayValOne.textContent = sliderOne.value;
            fillColor();
        }
        function slideTwo() {
            if (parseInt(sliderTwo.value) - parseInt(sliderOne.value) <= minGap) {
                sliderTwo.value = parseInt(sliderOne.value) + minGap;
            }
            displayValTwo.textContent = sliderTwo.value;
            fillColor();
        }
        function fillColor() {
            percent1 = (sliderOne.value / sliderMaxValue) * 100;
            percent2 = (sliderTwo.value / sliderMaxValue) * 100;
            sliderTrack.style.background = `linear-gradient(to right, #d7d8d8 ${percent1}% , #3a3535 ${percent1}% , #3a3535 ${percent2}%, #d7d8d8 ${percent2}%)`;
        }
    </script>

    <!-- jQuery ve jQuery UI kütüphanelerini yükleyin -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">



}
