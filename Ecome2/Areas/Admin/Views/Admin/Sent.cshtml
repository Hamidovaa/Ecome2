@model List<Message>
@section Styles {
    <style>
        .message {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }

        .unread {
            font-weight: bold;
            color: black;
        }

        .read {
            font-weight: normal;
            color: #888;
        }
        .trashBtn{
            color:#F46A6A;
            background-color: #f8f9fa;
            border:none;
            font-size:17px;
            font-weight:bolder;
        }
        .pdg{
            padding-top:70px;
        }
    </style>
}
<div class="container-fluid">

    <div class="row">
        <div class="col-12">
            <!-- Left sidebar -->
            <div class="email-leftbar card pdg">
                <button type="button" class="btn btn-danger btn-block waves-effect waves-light" data-bs-toggle="modal" data-bs-target="#composemodal">
                    Compose
                </button>
                <div class="mail-list mt-4">
                    <a asp-controller="Admin" asp-action="ListMessages"  >
                        <i class="mdi mdi-email-outline me-2"></i> Inbox
                        <span class="ms-1 float-end"></span>
                    </a>

                    <a asp-controller="Admin" asp-action="Sent" class="active">
                        <i class="mdi mdi-email-check-outline me-2"></i>Sent Mail
                    </a>
                  
                    
                
                </div>

                <div class="email-rightbar mb-3" id="messageContainer">
                    <!-- Mesajlar burada yüklenecek -->
                </div>


            </div>
            <!-- End Left sidebar -->
            <!-- Right Sidebar -->
            <div class="email-rightbar mb-3 pdg">

                <div class="card">

                    <ul class="message-list">
                        @foreach (var message in Model)
                        {
                            <li class="message @(message.IsRead ? "read" : "unread")">
                                <div class="col-mail col-md-2 col-lg-2 col-mail-1">
                                    <div class="checkbox-wrapper-mail">
                                        <input type="checkbox" id="chk3" checked>
                                        <label for="chk3" class="toggle"></label>
                                    </div>
                                    <a asp-controller="Admin" asp-action="Reademail" asp-route-id="@message.Id">@message.Author</a><span class="star-toggle far fa-star"></span>
                                </div>
                                <div class="col-mail col-lg-6 col-md-6 col-mail-2">
                                    <a asp-controller="Admin" asp-action="Reademail" asp-route-id="@message.Id" onclick="markAsRead(@message.Id)">
                                        <span class="teaser">@message.Body</span>
                                    </a>
                                    <div class="date">@message.DateSent.ToString("yyyy-MM-dd HH:mm:ss")</div>
                                </div>
                                <form asp-action="DeleteMessage" asp-route-id="@message.Id" method="post" class="float-end col-lg-1 col-md-1">
                                    <button type="submit" class="btn btn-danger btn-sm trashBtn"><i class="mdi mdi-trash-can-outline me-2"></i></button>
                                </form>
                            </li>
                        }

                    </ul>

                </div><!-- card -->

                <div class="row">
                    <div class="col-7">
                        Showing 1 - 20 of 1,524
                    </div>
                    <div class="col-5">
                        <div class="btn-group float-end">
                            <button type="button" class="btn btn-sm btn-success waves-effect"><i class="fa fa-chevron-left"></i></button>
                            <button type="button" class="btn btn-sm btn-success waves-effect"><i class="fa fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>

            </div> <!-- end Col-9 -->

        </div>

    </div><!-- End row -->

</div>

@section Scripts {
    <script>
        function markAsRead(messageId) {
            $.ajax({
                url: '/Admin/MarkAsRead',
                type: 'POST',
                data: { id: messageId },
                success: function (response) {
                    // İşlem başarılı, mesajı okunmuş olarak işaretle
                    console.log('Mesaj okunmuş olarak işaretlendi.');
                },
                error: function () {
                    console.error('Bir hata oluştu.');
                }
            });
        }
    </script>
    <script>
        function loadMessages(category) {
            $.ajax({
                url: '/Admin/' + category,
                type: 'GET',
                success: function (data) {
                    $('#message-list').html(data);
                },
                error: function () {
                    console.error('Mesajları yüklerken bir hata oluştu.');
                }
            });
        }
    </script>

}